{% load static %} 

<link rel="stylesheet" href="{% static '/css/bootstrap.min.css' %}" />
<nav class="navbar navbar-expand-lg bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Gestion D'Employees</a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
       
        <a href=" {% url 'absence' %}" class="text-decoration-none text-dark"
          ><li class="m-3">Ajout Absence</li></a
        >
        <a href="{% url 'afficher_vente' %}" class="text-decoration-none text-dark"
          ><li class="m-3">Ajout Avance</li></a
        >
        <a href="#" class="text-decoration-none text-dark"
        ><li class="m-3">List Employees</li></a
      >
      </ul>
    </div>
  </div>
</nav>



{% block content %}
<head> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script></head>
<!-- Partie 1 - Overview -->
<div class="overview">
    <div class="section">
        <h4>Nombre total des employés: {{ total_employees }}</h4>
    </div>
    <div class="section">
        <h4>Pourcentage d'absence aujourd'hui: {{ present_percentage }}%</h4>
    </div>
    <div class="section">
        <h4>Nombre total des employees absencent aujourd'hui: {{ total_absences }}</h4>
    </div>
</div>
{% block title %}Top Customer Chart{% endblock %}
<!-- Partie 2 - Chart d'absence pour l'année -->
<div class="chart">
    <!-- Utilisez un script pour générer le graphique avec JavaScript et Chart.js -->
    <canvas id="absenceChart" width="30" height="10"></canvas>
</div>

<script>
    // Script pour générer le graphique d'absence pour l'année
    var ctx = document.getElementById('absenceChart').getContext('2d');

    // Utilisez AJAX pour récupérer les données depuis l'API REST
    fetch('/centre/api/absence-chart/')
        .then(response => response.json())
        .then(data => {
            var labels = data.map(entry => entry.emp__nomPrenomE);
            var values = data.map(entry => entry.total_absences);

            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Nombre d\'absences',
                        data: values,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
{% endblock content %}
